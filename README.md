# Gameplay Video Analyzer

Annotate time ranges in game film, tag the action (SPIN, JUKE, etc.), and run analysis by counting defenders “in front” of the ball carrier. Outputs feed a simple graphs view.

## Stack

* **React** + **video.js** (YouTube + MP4)
* **Custom timeline** for range selection
* **CSS** in `src/styles.css` (no inline styles)
* **(Model)** currently a TFLite file in `public/models/` — see “Model status” below

---

## File structure

```
GAMEPLAY-VIDEO-ANALYZER/
├─ public/
│  ├─ index.html
│  └─ models/
│     └─ model.tflite            # replace here if you have a new model
├─ src/
│  ├─ components/
│  │  ├─ VideoPlayer.jsx         # playback, range select, annotate modal, Analyze button
│  │  ├─ AnnotationTimeline.jsx  # editable table of annotations (start/end/tag/modifier/down)
│  │  ├─ GraphsPanel.jsx         # shows counts returned by analysis (per tag)
│  │  └─ Loader.jsx              # small spinner
│  ├─ App.jsx                    # wires everything together, header pills, passes modelPath
│  ├─ index.js                   # React entry
│  └─ styles.css                 # all app styling + variables
├─ patches/                      # (optional) patch files for dependencies
├─ package.json                  # scripts (start/build/deploy) + deps
├─ package-lock.json
├─ .gitignore
└─ README.md
```

### What edits go where

* **Video controls / range selection / hotkeys** → `VideoPlayer.jsx`
* **Annotation modal fields (tag, modifier, down)** → `VideoPlayer.jsx`
* **Annotation table columns / CSV export** → `AnnotationTimeline.jsx`
* **Graphs rendering** → `GraphsPanel.jsx`
* **Styling** (buttons, modal, grid, etc.) → `styles.css`
* **Model path** passed to player → `App.jsx` (`<VideoPlayer modelPath="/models/…">`)

---

## Local setup

```bash
# 1) Clone
git clone <REPO_URL>
cd gameplay-video-analyzer

# 2) Install
npm install

# 3) Run dev server (http://localhost:3000)
npm start
```

---

## How to use (quick)

1. **Load a video** (YouTube URL or MP4).
2. **Make a selection**:

   * Hold **Shift** and drag on the scrub bar **or**
   * Use **[** to set Start, **]** to set End.
   * **,** frame back · **.** frame forward · **Space** play/pause
   * When you press **]**, playback auto-pauses at that moment.
3. **Annotate**: click **Annotate** → choose **Tag**, **Modifier**, **Down** → **Add**.
4. **Load schema CSV (optional)**: matches columns `TagName,StartTime,EndTime,Modifiers`.
5. **Analyze**: press **Analyze** to compute defender counts per tag (see model note below).
6. **View results**: open **Graphs** to see counts arrays grouped by tag.

---

## Deploy (GitHub Pages)

We publish the production build to the `gh-pages` branch using the `gh-pages` package. You **do not** switch branches manually.

```bash
# while on main
npm run deploy
```

This will:

1. build the app,
2. push the build artifacts to `gh-pages`,
3. leave you on `main`.

### One-time check

In `package.json`, ensure the homepage is set:

```json
"homepage": "https://<username>.github.io/<repo-name>/"
```

GitHub → **Settings → Pages** → Source = `gh-pages` branch.

---

## Branches and permissions

* **main**: working development branch
* **gh-pages**: generated by `npm run deploy` (don’t touch manually)

If a teammate has **Write** access and `main` isn’t protected, they can:

```bash
git push origin main      # update code only
npm run deploy            # publish the site
```

Pushing to `main` **does not** update the live site. `npm run deploy` does.

---

## Keyboard shortcuts

* **Space**: play/pause
* **,**: frame back
* **.**: frame forward
* **[**: set Start
* **]**: set End (also pauses playback)

---

## Common warnings

* **Source map warning from mediapipe `vision_bundle_mjs.js.map`**
  Harmless in dev. It’s a missing map in the npm package. Ignore it.

* **TFJS “kernel already registered” logs**
  Happens if the runtime is injected twice during hot reload. Harmless after a full refresh.

---

Questions? Look at `VideoPlayer.jsx` first—it’s the heart of the app.
